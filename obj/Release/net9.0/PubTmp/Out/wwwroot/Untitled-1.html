<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image and Sentiment Analysis</title>
</head>
<body>
    <h1>Upload Image</h1>
    <form id="uploadForm">
        <input type="file" id="imageUpload" accept="image/*">
        <button type="submit">Upload</button>
    </form>

    <h1>Sentiment Analysis</h1>
    <textarea id="reviewText" placeholder="Enter your review"></textarea>
    <button onclick="analyzeSentiment()">Analyze Review</button>
    <p id="sentimentResult"></p>

    <script>
        const apiKey = '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';

        // Phân tích cảm xúc của nhận xét
        async function analyzeSentiment() {
    const text = document.getElementById("reviewText").value;
    
    // Kiểm tra nếu người dùng chưa nhập nhận xét
    if (!text) {
        alert('Please enter some text for sentiment analysis');
        return;
    }

    try {
        const response = await fetch("https://api-inference.huggingface.co/models/distilbert-base-uncased-finetuned-sst-2-english", {
            method: 'POST',
            headers: {
                'Authorization': `Bearer ${apiKey}`,
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ inputs: text })
        });

        const result = await response.json();

        // Kiểm tra xem kết quả trả về có chứa 'label' không
        if (result && result[0] && result[0].label) {
            document.getElementById("sentimentResult").innerText = `Sentiment: ${result[0].label}`;
        } else {
            document.getElementById("sentimentResult").innerText = 'Could not analyze sentiment. Please try again later.';
        }
    } catch (error) {
        console.error('Error during sentiment analysis:', error);
        document.getElementById("sentimentResult").innerText = 'An error occurred while analyzing the sentiment.';
    }
}

        // Tải ảnh lên và tìm ảnh gần giống
        document.getElementById("uploadForm").addEventListener("submit", async function(event) {
            event.preventDefault();
            const file = document.getElementById("imageUpload").files[0];
            const formData = new FormData();
            formData.append("file", file);

            const response = await fetch("https://api-inference.huggingface.co/models/openai/clip-vit-base-patch16", {
                method: 'POST',
                headers: {
                    'Authorization': `Bearer ${apiKey}`
                },
                body: formData
            });

            const result = await response.json();
            console.log(result);
        });
    </script>
</body>
</html>
